{
  "states": {
    "pending": {
      "id": { "value": "pending" },
      "isFinal": false,
      "metadata": null
    },
    "confirmed": {
      "id": { "value": "confirmed" },
      "isFinal": false,
      "metadata": null
    },
    "shipped": {
      "id": { "value": "shipped" },
      "isFinal": false,
      "metadata": null
    },
    "delivered": {
      "id": { "value": "delivered" },
      "isFinal": true,
      "metadata": null
    },
    "cancelled": {
      "id": { "value": "cancelled" },
      "isFinal": true,
      "metadata": null
    }
  },
  "initialState": { "value": "pending" },
  "transitions": [
    {
      "from": { "value": "pending" },
      "to": { "value": "confirmed" },
      "eventType": { "value": "confirm" },
      "guard": { "==": [1, 1] },
      "effect": { "merge": [{ "var": "state" }, { "var": "event" }] },
      "dependencies": []
    },
    {
      "from": { "value": "pending" },
      "to": { "value": "cancelled" },
      "eventType": { "value": "cancel" },
      "guard": { "==": [1, 1] },
      "effect": { "merge": [{ "var": "state" }, { "cancelReason": { "var": "event.reason" } }] },
      "dependencies": []
    },
    {
      "from": { "value": "confirmed" },
      "to": { "value": "shipped" },
      "eventType": { "value": "ship" },
      "guard": { "==": [1, 1] },
      "effect": { "merge": [{ "var": "state" }, { "trackingNumber": { "var": "event.trackingNumber" } }] },
      "dependencies": []
    },
    {
      "from": { "value": "shipped" },
      "to": { "value": "delivered" },
      "eventType": { "value": "deliver" },
      "guard": { "==": [1, 1] },
      "effect": { "merge": [{ "var": "state" }, { "deliveredAt": { "var": "event.timestamp" } }] },
      "dependencies": []
    }
  ],
  "metadata": {
    "name": "SimpleOrderStateMachine",
    "description": "A basic order fulfillment state machine"
  }
}